# 新しい Outlook でデバッグする方法

## 前提条件

- 新しい Outlook に既にアドイン「OutlookCalendarManager」がサイドロードされていること
- 開発サーバーが `https://localhost:3000` で起動できること

---

## デバッグ手順

### 1. 開発サーバーを起動

VS Code のターミナルで：
```powershell
cd OutlookCalendarManager
npm run dev-server
```

サーバーが起動したら、`https://localhost:3000` が利用可能になります。

---

### 2. 新しい Outlook を開く

- **新しい Outlook** を起動（既に起動している場合はそのまま使用）
- メール作成画面を開く
- **「アプリ」ボタン**をクリック
- **「OutlookCalendarManager」** をクリックしてタスクペインを開く

---

### 3. VS Code から Edge にアタッチ

1. VS Code の**デバッグパネル**を開く（Ctrl+Shift+D）
2. 構成から **「新しい Outlook: Edge にアタッチ（手動起動）」** を選択
3. **F5** を押す

これで、新しい Outlook のタスクペイン内のコードにブレークポイントを設定してデバッグできます。

---

## 注意事項

- **開発サーバーは先に起動しておく必要があります**
- 新しい Outlook は Edge WebView2 を使用しているため、ポート 9229 でリモートデバッグが有効になっている必要があります
- アタッチできない場合は、新しい Outlook を一度閉じて再起動してみてください

---

## トラブルシューティング

### Edge にアタッチできない場合

1. 新しい Outlook を完全に閉じる
2. 開発サーバーを起動
3. 新しい Outlook を起動
4. アドインのタスクペインを開く
5. VS Code からアタッチを試す

### ポート 9229 が使用できない場合

新しい Outlook が Edge WebView2 のリモートデバッグを有効にしていない可能性があります。その場合は、新しい Outlook の設定で開発者モードを有効にする必要があるかもしれません。
